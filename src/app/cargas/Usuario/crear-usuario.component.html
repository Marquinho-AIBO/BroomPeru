<h2>Crear Usuario</h2>

<form (ngSubmit)="guardarUsuario()" #usuarioForm="ngForm">
  <div class="cont-cu">
    <div class="form-group">
    <label>Rol</label>
    <select id="sel-rol" name="rol" [(ngModel)]="usuario.rol" required>
      <option *ngFor="let perfil of perfiles" [value]="perfil.nombre">{{ perfil.nombre }}</option>
    </select>
  </div>
  <div id="sel-ruc" class="form-group" *ngIf="usuario.rol === 'Empresa'">
    <label>Empresa (RUC)</label>
    <select name="empresa_ruc" [(ngModel)]="usuario.nombre_usuario" required>
      <option value="">-- Seleccionar RUC disponible --</option>
      <option *ngFor="let ruc of rucsDisponibles" [value]="ruc">{{ ruc }}</option>
    </select>
  </div>
  
  <input type="hidden" name="empresa_id" [(ngModel)]="usuario.empresa_id"
  
  [required]="usuario.rol === 'Empresa'" *ngIf="usuario.rol === 'Empresa'">
    <div class="form-group">
    <label>Usuario</label>
    <input type="text" name="nombre_usuario" [(ngModel)]="usuario.nombre_usuario" required>
  </div>

  <div class="form-group">
    <label>Contrase침a</label>
    <input type="password" name="contrasena" [(ngModel)]="usuario.contrasena" required minlength="6">
  </div>
  

  </div>
  
  <div class="actions">
    <button class="btn-solid add" type="submit" [disabled]="usuarioForm.invalid">
      {{ usuario.id ? 'Actualizar' : 'Guardar' }}
    </button>
    <button class="btn-solid close" type="button" (click)="resetFormulario()">Cancelar</button>
  </div>
  
</form>

<hr>
<p *ngIf="mensaje">{{ mensaje }}</p>
<h3>Usuarios con Empresa</h3>
<div class="wrap-actions">
  <input class="form-control mb-2  buscador" type="text" [(ngModel)]="filtro" placeholder="Buscar usuario..." />
</div>

<div class="cont-table">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Usuario</th>
        <th>Contrase침a</th>
        <th>Rol</th>
        <!--th>Empresa ID</th-->
        <th colspan="2">Acci칩n</th> 
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let usuario of usuariosFiltradosPaginados">
        <td>{{ usuario.id }}</td>
        <td>{{ usuario.nombre_usuario }}</td>
         <td>{{ usuario.contrasena }}</td> 
        <td>{{ usuario.rol }}</td>
        <!--td>{{ usuario.empresa_id }}</td-->
        <td>
          <button type="button" class="btn-solid edit" (click)="seleccionarUsuario(usuario); $event.stopPropagation()">Editar</button>
        </td>
        <td>
     <button type="button" class="btn-solid edit" (click)="eliminarEmpresa(usuario.empresa_id)">游딈 Eliminar</button>

        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="form-group show-reg">
  <label for="registrosPorPagina">Mostrar</label>
  <select id="registrosPorPagina"
          class="form-control d-inline-block mx-2"
          [(ngModel)]="registrosPorPagina"
          (change)="paginaActual = 1"
          style="width: 5%;">
    <option *ngFor="let cantidad of opcionesCantidad" [value]="cantidad">{{ cantidad }}</option>
  </select>
  <small>registros por p치gina</small>
</div>
<nav aria-label="Page navigation">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="paginaActual === 1">
      <a class="page-nav" (click)="paginaActual = paginaActual - 1" [class.disabled]="paginaActual === 1">Anterior</a>
    </li>
    <li class="page-item" *ngFor="let p of totalPaginas" [class.active]="paginaActual === p">
      <a class="page-link" (click)="paginaActual = p">{{ p }}</a>
    </li>
    <li class="page-item" [class.disabled]="paginaActual === totalPaginas.length">
      <a class="page-nav" (click)="paginaActual = paginaActual + 1" [class.disabled]="paginaActual === totalPaginas.length">Siguiente</a>
    </li>
  </ul>
</nav>